!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):t.QRRecode=n()}(this,function(){"use strict";function t(t,n){console.warn("[QRRecode]:"+t,n)}function n(n,i,o){function a(){l.clearRect(0,0,c,f)}function r(){return a(),l.drawImage(i,0,0,h,u,0,0,c,f),Promise.resolve()}if(!(n instanceof HTMLCanvasElement))return t("<HTMLCanvasElement>backgroundCanvas",n),Promise.resolve();if(!(i instanceof HTMLCanvasElement))return t("<HTMLCanvasElement>foregroundCanvas",i),Promise.resolve();var s=n.width,d=n.height,h=i.width,u=i.height,c=s,f=d,g=n,l=g.getContext("2d");if(!o)return t("<Object>options",o),r();var m=+o.duration||0;if(!m)return t("<Number>options.duration",m),r();var v=""+o.type,b=o.callback,C=+new Date,p=C+m,H=document.createElement("canvas");H.getContext("2d").drawImage(g,0,0,c,f);var k={};return e.hasOwnProperty(v)?new Promise(function(t){function n(){a();var i=+new Date,o=Math.max(0,Math.min((i-C)/(p-C),1));!function t(n){return e[n].call(r,o,t)}(v),b&&b(o),o>=1?t():requestAnimationFrame(n)}var r={closure:k,options:o,backgroundWidth:s,backgroundHeight:d,backgroundCanvas:H,foregroundWidth:h,foregroundHeight:u,foregroundCanvas:i,destinationWidth:c,destinationHeight:f,destinationCanvas:g,destinationContext:l};requestAnimationFrame(n)}):(t("<Function>fn[type]",e),Promise.resolve())}var e=n.fn={};return n.add=function(t,n){e[t]=n},n.add("smooth-fade",function(t,n){var e=this.backgroundWidth,i=this.backgroundHeight,o=this.backgroundCanvas,a=this.foregroundWidth,r=this.foregroundHeight,s=this.foregroundCanvas,d=this.destinationWidth,h=this.destinationHeight,u=this.destinationContext;u.globalAlpha=1-t,u.drawImage(o,0,0,e,i,0,0,d,h),u.globalAlpha=t,u.drawImage(s,0,0,a,r,0,0,d,h),u.globalAlpha=1}),n.add("smooth-blur",function(t,n){var e=this.options,i=this.destinationContext,o=e.blur,a=void 0===o?5:o;i.filter="blur("+(1-Math.abs(2*t-1))*a+"px)",n("smooth-fade"),i.filter=""}),n.add("any-good-animation-idea",function(t,n){this.closure,this.options,this.backgroundWidth,this.backgroundHeight,this.backgroundCanvas,this.foregroundWidth,this.foregroundHeight,this.foregroundCanvas,this.destinationWidth,this.destinationHeight,this.destinationCanvas,this.destinationContext}),n});
